(this["webpackJsonpse325-assignment-01-frontend"]=this["webpackJsonpse325-assignment-01-frontend"]||[]).push([[0],{142:function(e,t,n){},175:function(e,t,n){"use strict";n.r(t);n(142);var a=n(0),s=n.n(a),r=n(12),i=n.n(r),c=n(11),o=n(21),l=n(15),u=n(237),j=n(209),h=n(231),d=n(232),b=n(207),g=n(106),f=n.n(g),O=n(120),m=n(206),x=n(208),p=n(17),v=n.n(p),C=n(235),w=n(105),S=n.n(w),k="/services",y="".concat(k,"/flights"),D="".concat(k,"/users"),R="".concat(k,"/bookings");function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",n=Object(a.useState)(!1),s=Object(l.a)(n,2),r=s[0],i=s[1],c=Object(a.useState)(!1),o=Object(l.a)(c,2),u=o[0],j=o[1];function h(){var n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=a.data,r=a.params,c=a.pathParams;return n="function"===typeof e?e(c):e,i(!0),j(!1),S()({url:n,method:t,data:s,params:r}).then((function(e){return i(!1),e})).catch((function(e){throw i(!1),j(!0),e}))}return{isInProgress:r,lastCallErrored:u,go:h}}function N(){return{createAccount:B(D,"post"),login:B("".concat(D,"/login"),"post"),logout:B("".concat(D,"/logout"),"get"),flightSearch:B(y,"get"),flightBookingInfo:B((function(e){var t=e.id;return"".concat(y,"/").concat(t,"/booking-info")}),"get"),book:B(R,"post"),myBookings:B(R,"get"),cancelBooking:B((function(e){var t=e.id;return"".concat(R,"/").concat(t)}),"delete")}}function Y(){var e=Object(C.a)(["authToken"]),t=Object(l.a)(e,1)[0],n=Object(a.useState)(!!t.authToken),s=Object(l.a)(n,2),r=s[0],i=s[1],c=N();return{isLoggedIn:r,isLoggingIn:c.login.isInProgress,login:function(e,t){return c.login.go({data:{username:e,password:t}}).then((function(){return i(!0)}))},isLoggingOut:c.logout.isInProgress,logout:function(){return c.logout.go().then((function(){return i(!1)}))}}}var F=n(2);function I(){return Object(F.jsxs)(O.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(F.jsx)(b.a,{color:"inherit",href:"https://canvas.auckland.ac.nz/courses/62448",children:"SOFTENG 325 S2 2021,"})," ",v()().format("MMMM D, YYYY"),"."]})}var T=Object(m.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function E(e){var t=e.onSubmit,n=e.buttonText,s=e.enabled,r=e.children,i=T(),o=Object(a.useState)(""),b=Object(l.a)(o,2),g=b[0],m=b[1],p=Object(a.useState)(""),v=Object(l.a)(p,2),C=v[0],w=v[1],S=Object(c.f)();return Y().isLoggedIn&&S.replace("/"),Object(F.jsxs)(x.a,{component:"main",maxWidth:"xs",children:[Object(F.jsxs)("div",{className:i.paper,children:[Object(F.jsx)(u.a,{className:i.avatar,children:Object(F.jsx)(f.a,{})}),Object(F.jsx)(O.a,{component:"h1",variant:"h5",children:n}),Object(F.jsxs)("form",{className:i.form,onSubmit:function(e){e.preventDefault(),t&&t(g,C)},children:[Object(F.jsx)(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoFocus:!0,value:g,onChange:function(e){return m(e.target.value)}}),Object(F.jsx)(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:C,onChange:function(e){return w(e.target.value)}}),Object(F.jsx)(j.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:i.submit,disabled:!s,children:n}),r]})]}),Object(F.jsx)(d.a,{mt:8,children:Object(F.jsx)(I,{})})]})}var A=n(56),X=s.a.createContext({});function q(){return Object(a.useContext)(X)}function M(e){var t=e.children,n=Y(),s=N(),r=Object(a.useState)([]),i=Object(l.a)(r,2),c=i[0],o=i[1],u=Object(a.useState)({origin:"Auckland",destination:"Sydney",searchByDate:!1,departureDate:v()().format("YYYY-MM-DD")}),j=Object(l.a)(u,2),h={auth:n,api:s,flights:c,setFlights:o,searchQuery:j[0],setSearchQuery:j[1]};return Object(F.jsx)(X.Provider,{value:h,children:t})}function P(){var e=q().api.createAccount,t=Object(c.f)(),n=Object(o.b)().enqueueSnackbar;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(A.a,{children:Object(F.jsx)("title",{children:"SE325 Flight Booker - Sign up"})}),Object(F.jsx)(E,{buttonText:"Create an account",onSubmit:function(a,s){e.go({username:a,password:s}).then((function(){n("Account creation successful! You can now login",{variant:"success"}),t.push("/login")})).catch((function(e){e.response&&409===e.response.status?n("That username already exists",{variant:"error"}):(console.log(e),n("Something unexpected went wrong!",{variant:"error"}))}))},enabled:!e.isInProgress})]})}var W=n(210),K=n(27);function J(){var e=Object(c.g)();return new URLSearchParams(e.search)}function L(){var e=q().auth,t=e.login,n=e.isLoggingIn,a=Object(o.b)().enqueueSnackbar,s=Object(c.f)(),r=J();return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(A.a,{children:Object(F.jsx)("title",{children:"SE325 Flight Booker - Sign in"})}),Object(F.jsx)(E,{buttonText:"Sign in",onSubmit:function(e,n){t(e,n).then((function(){a("Logged in successfully!",{variant:"success"});var e=r.get("from");e?s.push(decodeURIComponent(e)):s.push("/")})).catch((function(e){e.response&&401===e.response.status?a("That username or password was incorrect!",{variant:"error"}):a("Something unexpected went wrong!",{variant:"error"})}))},enabled:!n,children:Object(F.jsxs)(W.a,{container:!0,children:[Object(F.jsx)(W.a,{item:!0,xs:!0}),Object(F.jsx)(W.a,{item:!0,children:Object(F.jsx)(b.a,{variant:"body2",component:K.b,to:"/signup",children:"Don't have an account? Sign Up"})})]})})]})}var U=n(222),Z=n(223),_=n(84),H=n(211),G=n(239),z=n(230),Q=Object(m.a)((function(e){return{grid:{marginBottom:e.spacing(2)}}}));function V(e){var t=e.onSearch,n=e.enabled,a=Q(),s=q(),r=s.searchQuery,i=s.setSearchQuery,c=r.origin,o=r.destination,l=r.searchByDate,u=r.departureDate;function d(e){i(Object(_.a)(Object(_.a)({},r),e))}return Object(F.jsx)(x.a,{maxWidth:"md",component:"div",children:Object(F.jsx)("form",{onSubmit:function(e){e.preventDefault(),t&&t(r)},children:Object(F.jsxs)(W.a,{container:!0,spacing:2,className:a.grid,children:[Object(F.jsxs)(W.a,{item:!0,xs:12,children:[Object(F.jsx)(O.a,{variant:"subtitle1",children:"Where are you travelling?"}),Object(F.jsxs)(W.a,{container:!0,spacing:2,children:[Object(F.jsx)(W.a,{item:!0,xs:12,sm:6,children:Object(F.jsx)(h.a,{required:!0,fullWidth:!0,label:"From",helperText:"Airport or City",variant:"outlined",value:c,onChange:function(e){return function(e){return d({origin:e})}(e.target.value)}})}),Object(F.jsx)(W.a,{item:!0,xs:12,sm:6,children:Object(F.jsx)(h.a,{required:!0,fullWidth:!0,label:"To",helperText:"Airport or City",variant:"outlined",value:o,onChange:function(e){return function(e){return d({destination:e})}(e.target.value)}})})]})]}),Object(F.jsx)(W.a,{item:!0,xs:12,children:Object(F.jsx)(H.a,{control:Object(F.jsx)(G.a,{checked:l,onChange:function(e){return function(e){return d({searchByDate:e})}(e.target.checked)},color:"primary"}),label:"Search by departure date?"})}),l&&Object(F.jsxs)(W.a,{item:!0,xs:12,children:[Object(F.jsx)(O.a,{variant:"subtitle1",children:"When would you like to leave?"}),Object(F.jsx)(z.a,{fullWidth:!0,inputVariant:"outlined",value:v()(u),onChange:function(e){return d({departureDate:e.format("YYYY-MM-DD")})}})]}),Object(F.jsx)(W.a,{item:!0,container:!0,xs:12,justifyContent:"flex-end",children:Object(F.jsx)(j.a,{type:"submit",color:"primary",variant:"contained",disabled:!n,children:"Search"})})]})})})}var $=n(214),ee=n(121),te=n(215),ne=n(216),ae=n(217),se=n(218),re=n(219);function ie(e,t){return v()(t.substring(0,t.indexOf("["))).tz(e.timeZone).format("MMM D, YYYY h:mm A ([UTC]Z)")}function ce(){return{getTime:ie}}var oe=Object(m.a)((function(e){return{table:{minWidth:800}}}));function le(e){var t=e.flights,n=e.onBook,a=e.hideBookButton,s=oe();return Object(F.jsx)($.a,{component:ee.a,children:Object(F.jsxs)(te.a,{className:s.table,children:[Object(F.jsx)(ne.a,{children:Object(F.jsxs)(ae.a,{children:[Object(F.jsx)(se.a,{children:"Name"}),Object(F.jsx)(se.a,{}),Object(F.jsx)(se.a,{children:"Departs"}),Object(F.jsx)(se.a,{}),Object(F.jsx)(se.a,{children:"Arrives"}),Object(F.jsx)(se.a,{}),Object(F.jsx)(se.a,{children:"Aircraft"}),!a&&Object(F.jsx)(se.a,{children:"Book"})]})}),Object(F.jsx)(re.a,{children:t.map((function(e){return Object(F.jsx)(ue,{flight:e,onBook:n,hideBookButton:a},e.id)}))})]})})}function ue(e){var t=e.flight,n=e.onBook,a=e.hideBookButton,s=ce().getTime;return Object(F.jsxs)(ae.a,{children:[Object(F.jsx)(se.a,{children:t.name}),Object(F.jsx)(se.a,{children:"\u2708"}),Object(F.jsxs)(se.a,{children:[s(t.origin,t.departureTime),Object(F.jsx)("br",{}),"From ",t.origin.name," (",t.origin.code,")"]}),Object(F.jsx)(se.a,{children:"\u2708"}),Object(F.jsxs)(se.a,{children:[s(t.destination,t.arrivalTime),Object(F.jsx)("br",{}),"From ",t.destination.name," (",t.destination.code,")"]}),Object(F.jsx)(se.a,{children:"\u2708"}),Object(F.jsx)(se.a,{children:t.aircraftName}),!a&&Object(F.jsx)(se.a,{children:Object(F.jsx)(j.a,{variant:"contained",color:"secondary",onClick:function(){return n(t)},children:"Book"})})]})}var je=n(220),he=n(213),de=n(221),be=Object(m.a)((function(e){return{plane:{marginRight:e.spacing(2)},title:{flexGrow:1,textDecoration:"none"},bookButton:{marginRight:e.spacing(2)}}}));function ge(){var e=be(),t=q().auth,n=t.logout,a=t.isLoggedIn,s=Object(o.b)().enqueueSnackbar,r=Object(c.f)();return Object(F.jsx)(je.a,{position:"static",children:Object(F.jsxs)(he.a,{children:[Object(F.jsx)(de.a,{color:"inherit",className:e.plane}),Object(F.jsx)(O.a,{variant:"h6",color:"inherit",className:e.title,component:K.b,to:"/",children:"SE325 Flight Booker"}),Object(F.jsx)(j.a,{color:"inherit",className:e.bookButton,component:K.b,to:"/",children:"Search for flights"}),a&&Object(F.jsx)(j.a,{color:"inherit",className:e.bookButton,component:K.b,to:"/my-bookings",children:"My bookings"}),a?Object(F.jsx)(j.a,{color:"inherit",onClick:function(){n().then((function(){s("Successfully logged out",{variant:"success"}),r.push("/")})).catch((function(e){console.error(e),s("Unknown error when logging out!",{variant:"error"})}))},children:"Sign out"}):Object(F.jsx)(j.a,{color:"inherit",component:K.b,to:"/login",children:"Sign in"})]})})}function fe(e){var t=e.children,n=e.requiresAuth,a=q().auth.isLoggedIn,s=Object(c.f)(),r=Object(c.g)();if(!a&&n){var i=encodeURIComponent("".concat(r.pathname).concat(r.search));return s.replace("/login?from=".concat(i)),null}return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(ge,{}),Object(F.jsx)(x.a,{maxWidth:"lg",component:"main",children:t})]})}var Oe=Object(m.a)((function(e){return{header:{marginTop:e.spacing(2)}}}));function me(){var e=Oe(),t=q(),n=t.api,a=t.flights,s=t.setFlights,r=n.flightSearch,i=Object(o.b)().enqueueSnackbar,l=Object(c.f)();return Object(F.jsxs)(fe,{children:[Object(F.jsx)(O.a,{className:e.header,variant:"h3",gutterBottom:!0,children:"Search for flights"}),Object(F.jsx)(V,{enabled:!r.isInProgress,onSearch:function(e){var t={origin:e.origin,destination:e.destination};e.searchByDate&&(t.departureDate=e.departureDate),r.go({params:t}).then((function(e){i("".concat(e.data.length," flight(s) found!"),{variant:"success"}),s(e.data)})).catch((function(e){console.error(e),i("Unexpected error occurred!",{variant:"error"})}))}}),r.isInProgress&&Object(F.jsx)(U.a,{}),Object(F.jsx)(Z.a,{}),Object(F.jsx)(O.a,{className:e.header,variant:"h3",gutterBottom:!0,children:"Search results"}),a&&a.length>0?Object(F.jsxs)("div",{children:[Object(F.jsxs)(O.a,{variant:"subtitle1",children:["\u2708 We found ",a.length," flights for you!"]}),Object(F.jsx)(le,{flights:a,onBook:function(e){l.push("/book?flightId=".concat(e.id))}})]}):Object(F.jsx)(O.a,{variant:"subtitle1",children:"\u2708 Nothing yet. Use the form above to search for flights!"})]})}var xe=n(74),pe=n(47),ve=n(224),Ce=n(225),we=n(226);function Se(e){var t=e.cabinClass,n=e.numRows,a=e.startingRowNumber,s=e.seatCodeData,r=e.graphicsData;this.cabinClass=t,this.numRows=n,this.startingRowNumber=a,this.seatCodeData=s,this.graphicsData=r,this.getCapacity=function(){return this.numRows*this.seatCodeData.length},this.isValidSeatCode=function(e){var t=parseInt(e.substring(0,e.length-1)),n=e.substring(e.length-1),a=t>=this.startingRowNumber&&t<this.startingRowNumber+this.numRows,s=this.seatCodeData.includes(n);return a&&s},this.allSeatCodes=null,this.getSeatCodes=function(){if(null===this.allSeatCodes){this.allSeatCodes=[];for(var e=this.startingRowNumber;e<this.startingRowNumber+this.numRows;e++)for(var t=0;t<this.seatCodeData.length;t++)this.allSeatCodes.push("".concat(e).concat(this.seatCodeData.charAt(t)))}return this.allSeatCodes},this.seatCoords=null,this.getSeatCoords=function(){if(null===this.seatCoords){this.seatCoords=[];var e,t=0,n=0,a=this.getSeatCodes(),s=this.graphicsData,r=s.columnXOffsets,i=s.firstRowYOffset,c=s.rowSpacing,o=s.columnYOffsets,l=Object(pe.a)(a);try{for(l.s();!(e=l.n()).done;){var u=e.value,j=i+t*c+o[n],h=r[n];this.seatCoords.push({x:h,y:j,seatCode:u}),++n===this.seatCodeData.length&&(n=0,t++)}}catch(d){l.e(d)}finally{l.f()}}return this.seatCoords}}function ke(e){var t=e.id,n=e.name,a=e.seatingZones,s=e.graphicsData;this.id=t,this.name=n,this.seatingZones=a,this.graphicsData=s,this.getTotalSeatingCapacity=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=0,a=Object(pe.a)(this.seatingZones);try{for(a.s();!(e=a.n()).done;){var s=e.value;t&&s.cabinClass!==t||(n+=s.getCapacity())}}catch(r){a.e(r)}finally{a.f()}return n},this.getCabinClass=function(e){var t,n=Object(pe.a)(this.seatingZones);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.isValidSeatCode(e))return a.cabinClass}}catch(s){n.e(s)}finally{n.f()}return null},this.seatCoords=null,this.getSeatCoords=function(){if(null===this.seatCoords){this.seatCoords=[];var e,t=Object(pe.a)(this.seatingZones);try{for(t.s();!(e=t.n()).done;){var n,a=e.value;(n=this.seatCoords).push.apply(n,Object(xe.a)(a.getSeatCoords()))}}catch(s){t.e(s)}finally{t.f()}}return this.seatCoords}}var ye={"787-9 Dreamliner":new ke({id:1,name:"787-9 Dreamliner",seatingZones:[new Se({cabinClass:"Business",numRows:6,startingRowNumber:1,seatCodeData:"AJK",graphicsData:{columnXOffsets:[141,209,279],firstRowYOffset:300,rowSpacing:34,columnYOffsets:[0,-6,0]}}),new Se({cabinClass:"Premium",numRows:3,startingRowNumber:23,seatCodeData:"ABDEFJK",graphicsData:{columnXOffsets:[140,159,194,213,232,264,282],firstRowYOffset:529,rowSpacing:33,columnYOffsets:[0,0,-3,-3,-3,0,0]}}),new Se({cabinClass:"Economy",numRows:1,startingRowNumber:34,seatCodeData:"JK",graphicsData:{columnXOffsets:[268,282],firstRowYOffset:724,rowSpacing:0,columnYOffsets:[0,0]}}),new Se({cabinClass:"Economy",numRows:15,startingRowNumber:35,seatCodeData:"ABCDEFHJK",graphicsData:{columnXOffsets:[140,154,168,198,212,226,254,268,282],firstRowYOffset:747,rowSpacing:22,columnYOffsets:[0,0,0,-7,-7,-7,0,0,0]}}),new Se({cabinClass:"Economy",numRows:2,startingRowNumber:50,seatCodeData:"ABCHJK",graphicsData:{columnXOffsets:[140,154,168,254,268,282],firstRowYOffset:1163,rowSpacing:22,columnYOffsets:[0,0,0,0,0,0]}}),new Se({cabinClass:"Economy",numRows:12,startingRowNumber:52,seatCodeData:"ABCDEFHJK",graphicsData:{columnXOffsets:[140,154,168,198,212,226,254,268,282],firstRowYOffset:1208,rowSpacing:22,columnYOffsets:[0,0,0,-8,-8,-8,0,0,0]}}),new Se({cabinClass:"Economy",numRows:2,startingRowNumber:64,seatCodeData:"DEF",graphicsData:{columnXOffsets:[198,212,226],firstRowYOffset:1463,rowSpacing:22,columnYOffsets:[0,0,0]}})],graphicsData:{imageName:"Air_New_Zealand_Boeing_787-9.png",width:425,height:1890}}),"777-200ER":new ke({id:2,name:"777-200ER",seatingZones:[new Se({cabinClass:"Business",numRows:2,startingRowNumber:11,seatCodeData:"ADFK",graphicsData:{columnXOffsets:[185,249,282,345],firstRowYOffset:311,rowSpacing:74,columnYOffsets:[0,0,0,0]}}),new Se({cabinClass:"Business",numRows:4,startingRowNumber:14,seatCodeData:"ADFK",graphicsData:{columnXOffsets:[185,249,282,345],firstRowYOffset:459,rowSpacing:74,columnYOffsets:[0,0,0,0]}}),new Se({cabinClass:"Business",numRows:1,startingRowNumber:18,seatCodeData:"DF",graphicsData:{columnXOffsets:[249,282],firstRowYOffset:756,rowSpacing:74,columnYOffsets:[0,0]}}),new Se({cabinClass:"Economy",numRows:16,startingRowNumber:31,seatCodeData:"ABCDEGHJK",graphicsData:{columnXOffsets:[177,192,208,249,264,280,321,337,352],firstRowYOffset:884,rowSpacing:23,columnYOffsets:[0,0,0,0,0,0,0,0,0]}}),new Se({cabinClass:"Economy",numRows:1,startingRowNumber:47,seatCodeData:"ACDEGHK",graphicsData:{columnXOffsets:[177,192,249,264,280,337,352],firstRowYOffset:1250,rowSpacing:23,columnYOffsets:[0,0,0,0,0,0,0]}}),new Se({cabinClass:"Economy",numRows:2,startingRowNumber:48,seatCodeData:"AC",graphicsData:{columnXOffsets:[177,192],firstRowYOffset:1382,rowSpacing:23,columnYOffsets:[0,0]}}),new Se({cabinClass:"Economy",numRows:10,startingRowNumber:50,seatCodeData:"ABCDEGHJK",graphicsData:{columnXOffsets:[177,192,208,249,264,280,321,337,352],firstRowYOffset:1429,rowSpacing:23,columnYOffsets:[0,0,0,-5,-5,-5,0,0,0]}})],graphicsData:{imageName:"Singapore_Air_Boeing_777-200_ER_new.png",width:531,height:2094}})};var De=Object(m.a)((function(e){return{root:{display:"flex",justifyContent:"center"},container:{position:"relative"},img:{position:"absolute",top:0,left:0,zIndex:0},seatButton:{position:"absolute",top:0,left:0,zIndex:1,width:21,height:21,borderRadius:10,backgroundColor:"transparent",transition:"background-color 0.2s ease","&:hover":{backgroundColor:"rgba(0, 0, 255, 0.2)"}}}}));function Re(e){var t=e.aircraft,n=e.bookedSeats,a=e.selectedSeats,s=e.onSeatClick,r=De(),i=t.graphicsData,c=i.width,o=i.height,l=i.imageName;return Object(F.jsx)(ee.a,{elevation:2,children:Object(F.jsx)("div",{className:r.root,children:Object(F.jsxs)("div",{className:r.container,style:{width:c,height:o},children:[Object(F.jsx)("img",{src:l,className:r.img}),Object(F.jsx)(Be,{aircraft:t,classes:r,onClick:s,bookedSeats:n,selectedSeats:a})]})})})}function Be(e){var t=e.aircraft,n=e.classes,a=e.onClick,s=e.bookedSeats,r=e.selectedSeats;return t.getSeatCoords().map((function(e,t){return Object(F.jsx)("div",{className:n.seatButton,onClick:function(t){s.includes(e.seatCode)||a(t,e)},style:{top:e.y-10,left:e.x-10,backgroundColor:s.includes(e.seatCode)?"rgba(255, 0, 0, 0.5)":r.includes(e.seatCode)?"rgba(0, 255, 0, 0.5)":void 0}},t)}))}var Ne=Object(m.a)((function(e){return{header:{marginTop:e.spacing(2)},sticky:{position:"sticky",top:e.spacing(2)}}}));function Ye(){var e=Ne(),t=N(),n=t.flightBookingInfo,s=t.book,r=Object(a.useState)(null),i=Object(l.a)(r,2),u=i[0],j=i[1],h=J(),b=parseInt(h.get("flightId")),g=q().flights.find((function(e){return e.id===b})),f=ye[g.aircraftName],m=Object(a.useState)([]),x=Object(l.a)(m,2),p=x[0],v=x[1],C=Object(o.b)().enqueueSnackbar,w=Object(c.f)(),S=0;if(u){var k,y=Object(pe.a)(p);try{for(y.s();!(k=y.n()).done;){var D=k.value,R=f.getCabinClass(D);S+=u.pricingInfo[R]}}catch(B){y.e(B)}finally{y.f()}}return Object(a.useEffect)((function(){n.go({pathParams:{id:b}}).then((function(e){return j(e.data)})).catch((function(e){return console.error(e)}))}),[b]),Object(F.jsx)(fe,{requiresAuth:!0,children:Object(F.jsxs)(W.a,{container:!0,spacing:2,children:[Object(F.jsxs)(W.a,{item:!0,xs:12,children:[Object(F.jsxs)(O.a,{variant:"h3",className:e.header,gutterBottom:!0,children:["Booking for ",g.name]}),Object(F.jsx)(le,{flights:[g],hideBookButton:!0})]}),n.isInProgress||!u?Object(F.jsxs)(W.a,{item:!0,xs:12,children:[Object(F.jsx)(O.a,{variant:"h6",gutterBottom:!0,children:"Loading..."}),Object(F.jsx)(U.a,{})]}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(W.a,{item:!0,children:Object(F.jsx)(Re,{aircraft:f,bookedSeats:u.bookedSeats,selectedSeats:p,onSeatClick:function(e,t){p.includes(t.seatCode)?v(p.filter((function(e){return e!==t.seatCode}))):v([].concat(Object(xe.a)(p),[t.seatCode]))}})}),Object(F.jsx)(W.a,{item:!0,xs:!0,children:Object(F.jsxs)("div",{className:e.sticky,children:[Object(F.jsx)(Fe,{flight:g,aircraft:f,bookingInfo:u}),Object(F.jsx)(d.a,{mt:2,children:Object(F.jsx)(Ie,{className:e.yourBooking,selectedSeats:p,cost:S,onBookClick:function(){var e={flightId:g.id,requestedSeats:p};s.go({data:e}).then((function(e){C("Booking created!",{variant:"success"}),w.push("/my-bookings")})).catch((function(e){C("Something went wrong with your booking!",{variant:"error"})}))}})})]})})]})]})})}function Fe(e){var t=e.flight,n=e.bookingInfo,a=e.aircraft,s=ce().getTime,r=a.getTotalSeatingCapacity(),i=r-n.bookedSeats.length;return Object(F.jsx)(ve.a,{children:Object(F.jsxs)(Ce.a,{children:[Object(F.jsx)(O.a,{variant:"h4",gutterBottom:!0,children:"Flight summary"}),Object(F.jsxs)(O.a,{variant:"subtitle1",children:["Flight ",t.name," to ",t.destination.name," (",t.destination.code,")"]}),Object(F.jsxs)(O.a,{variant:"body1",children:["Departs ",t.origin.name," on ",s(t.origin,t.departureTime),", arrives ",s(t.destination,t.arrivalTime),"."]}),Object(F.jsxs)(O.a,{variant:"body1",children:[Object(F.jsx)("strong",{children:"Capacity:"})," ",r," seats (",i," remaining)."]})]})})}function Ie(e){var t=e.selectedSeats,n=e.cost,a=e.onBookClick;return Object(F.jsxs)(ve.a,{children:[Object(F.jsxs)(Ce.a,{children:[Object(F.jsx)(O.a,{variant:"h4",gutterBottom:!0,children:"Your booking"}),Object(F.jsx)(O.a,{variant:"body1",children:Object(F.jsxs)("strong",{children:["Your seats: ",t.join(", ")]})}),Object(F.jsx)(O.a,{variant:"body1",children:Object(F.jsxs)("strong",{children:["Cost: $",n,".00"]})})]}),Object(F.jsx)(we.a,{children:Object(F.jsx)(j.a,{variant:"contained",color:"secondary",onClick:a,children:"Book it!"})})]})}var Te=Object(m.a)((function(e){return{header:{marginTop:e.spacing(2)}}}));function Ee(){var e=Object(o.b)().enqueueSnackbar,t=Te(),n=N(),s=n.myBookings,r=n.cancelBooking,i=Object(a.useState)(!1),c=Object(l.a)(i,2),u=c[0],j=c[1],h=Object(a.useState)([]),d=Object(l.a)(h,2),b=d[0],g=d[1];function f(t){r.go({pathParams:{id:t.id}}).then((function(){e("Booking cancelled!",{variant:"error"}),j(!u)})).catch((function(t){console.error(t),e("Unexpected error when cancelling!",{variant:"error"})}))}return console.log(b),Object(a.useEffect)((function(){s.go().then((function(e){g(e.data)}))}),[u]),Object(F.jsxs)(fe,{requiresAuth:!0,children:[Object(F.jsx)(O.a,{variant:"h3",className:t.header,gutterBottom:!0,children:"My bookings"}),!b&&Object(F.jsx)(U.a,{}),b&&Object(F.jsx)($.a,{component:ee.a,children:Object(F.jsxs)(te.a,{children:[Object(F.jsx)(ne.a,{children:Object(F.jsxs)(ae.a,{children:[Object(F.jsx)(se.a,{children:"Flight"}),Object(F.jsx)(se.a,{children:"Departs"}),Object(F.jsx)(se.a,{children:"Arrives"}),Object(F.jsx)(se.a,{children:"My seats"}),Object(F.jsx)(se.a,{children:"Booking fee"}),Object(F.jsx)(se.a,{children:"Cancel"})]})}),Object(F.jsx)(re.a,{children:b.map((function(e){return Object(F.jsx)(Ae,{booking:e,onCancel:f},e.id)}))})]})})]})}function Ae(e){var t=e.booking,n=e.onCancel,a=ce().getTime,s=t.flight,r=t.bookedSeats,i=t.totalCost,c=s.origin,o=s.departureTime,l=s.destination,u=s.arrivalTime;return Object(F.jsxs)(ae.a,{children:[Object(F.jsx)(se.a,{children:s.name}),Object(F.jsxs)(se.a,{children:[a(c,o),Object(F.jsx)("br",{}),"From ",c.name," (",c.code,")"]}),Object(F.jsxs)(se.a,{children:[a(l,u),Object(F.jsx)("br",{}),"From ",l.name," (",l.code,")"]}),Object(F.jsx)(se.a,{children:r.join(", ")}),Object(F.jsxs)(se.a,{children:["$",i,".00"]}),Object(F.jsx)(se.a,{children:Object(F.jsx)(j.a,{variant:"contained",color:"secondary",onClick:function(){return n(t)},children:"Cancel"})})]})}var Xe=function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(A.a,{children:Object(F.jsx)("title",{children:"SE325 Flight Booker"})}),Object(F.jsxs)(c.c,{children:[Object(F.jsx)(c.a,{path:"/login",children:Object(F.jsx)(L,{})}),Object(F.jsx)(c.a,{path:"/signup",children:Object(F.jsx)(P,{})}),Object(F.jsx)(c.a,{path:"/book",children:Object(F.jsx)(Ye,{})}),Object(F.jsx)(c.a,{path:"/my-bookings",children:Object(F.jsx)(Ee,{})}),Object(F.jsx)(c.a,{path:"*",children:Object(F.jsx)(me,{})})]})]})},qe=n(229),Me=n(18),Pe=n(110),We=n(115),Ke=n(227),Je=n(228),Le=n(113),Ue=n.n(Le),Ze=n(114),_e=n.n(Ze);v.a.extend(Ue.a),v.a.extend(_e.a);var He=Object(We.a)({palette:{background:{default:"#FFFFFF"}}});i.a.render(Object(F.jsxs)(Ke.a,{theme:He,children:[Object(F.jsx)(Je.a,{}),Object(F.jsx)(Me.a,{utils:Pe.a,children:Object(F.jsx)(qe.a,{children:Object(F.jsx)(o.a,{maxSnack:1,children:Object(F.jsx)(K.a,{children:Object(F.jsx)(M,{children:Object(F.jsx)(Xe,{})})})})})})]}),document.getElementById("root"))}},[[175,1,2]]]);
//# sourceMappingURL=main.323e8834.chunk.js.map